---


---

<p>In these series of posts, we will go through the steps required to install Configuration Manager in a simple LAB environment. The LAB environment will be referenced in future posts as we explore Configuration Manager further. See  <a href="">Part 1</a>  for an overview of the LAB environment.</p>
<p>Quick Jump:<br>
<a href="">Part 1 – Overview and Domain Controller installation</a><br>
<a href="">Part 2 – Management Server Installation</a><br>
<a href="">Part 3 – Installing SQL Server</a><br>
<a href="">Part 4 – Configuration Manager Prerequisites</a><br>
<a href="">Part 5 – Installing Configuration Manager</a></p>
<p>In this post we will install and configure all the prerequisites required to install Configuration Manager. Make sure the server (LABCM01) is restarted after completing all these tasks.</p>
<h3 id="local-admin-rights">Local Admin Rights</h3>
<p>The Configuration Manager server needs to be a local administrator, use the PowerShell script below to make LABCM01 part of the local Administrators group or add it manually using Computer Management.</p>
<pre class=" language-powershell"><code class="prism  language-powershell"><span class="token variable">$CMServer</span> = <span class="token string">"LABCM01"</span>
<span class="token variable">$Domain</span> = <span class="token string">"lab.local"</span>

<span class="token variable">$group</span> = <span class="token string">"WinNT://<span class="token variable">$CMServer</span>/Administrators,group"</span>
<span class="token variable">$member</span> = <span class="token string">"WinNT://<span class="token variable">$domain</span>/<span class="token variable">$CMServer</span>`$"</span>
<span class="token punctuation">(</span><span class="token namespace">[ADSI]</span><span class="token variable">$group</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token variable">$member</span><span class="token punctuation">)</span>
</code></pre>
<p>The local Administrator group should look like this:</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ConfigMgr_Prerequisites1.png" alt=""></p>
<h3 id="configmgr-content-share-and-structure">ConfigMgr Content Share and Structure</h3>
<p>We need to create a content share where the source files for our applications, packages and operating system images will be located. The script below will create the share along with an example structure. The LocalDrive variable at the top should be the disk letter assigned to the Content disk.</p>
<pre class=" language-powershell"><code class="prism  language-powershell"><span class="token variable">$LocalDrive</span>=<span class="token string">"F:"</span>

<span class="token function">Set-Location</span> <span class="token variable">$LocalDrive</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name ConfigMgr <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">Set-Location</span> <span class="token string">"<span class="token variable">$LocalDrive</span>\ConfigMgr"</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Software"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Updates"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 7"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 7\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 7\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 7\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 8"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 8\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 8\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 8\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 10"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 10\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 10\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\Windows 10\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\3.0"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\3.0\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\3.0\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\3.0\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\4.0"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\4.0\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\4.0\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\4.0\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\5.0"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\5.0\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\5.0\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\5.0\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\10"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\10\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\10\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\Drivers\WinPE\10\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\App-V"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\BootImages"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\OSImages"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\OSImages\Windows 7"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\OSImages\Windows 8"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\OSImages\Windows 10"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\OSInstall"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\OSInstall\Windows 7"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\OSInstall\Windows 8"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\OSInstall\Windows 10"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\MDTToolkit"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\MDTSettings"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\Drivers"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Content\OSD\MDTSettings\Deploy"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"InstallationUpdates"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"BootImageFiles"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Captures"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Hotfixes"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Scripts"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Scripts\PS"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Scripts\VBS"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"StateCapture"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Tools"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Tools\PSTools"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Stuff"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"MDTLogs"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 7"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 7\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 7\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 7\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 8"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 8\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 8\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 8\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 10"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 10\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 10\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\Windows 10\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\3.0"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\3.0\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\3.0\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\3.0\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\4.0"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\4.0\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\4.0\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\4.0\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\5.0"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\5.0\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\5.0\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\5.0\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\10"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\10\Dell"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\10\HP"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Drivers\WinPE\10\Lenovo"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\MOFs"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token function">New-Item</span> <span class="token operator">-</span><span class="token function">Type</span> Directory <span class="token operator">-</span>Name <span class="token string">"Import\Baselines"</span> <span class="token operator">-</span>Force <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
New<span class="token operator">-</span>SmbShare <span class="token operator">-</span>Name ConfigMgr <span class="token operator">-</span>Path <span class="token string">"<span class="token variable">$LocalDrive</span>\ConfigMgr"</span> <span class="token operator">-</span>FullAccess Everyone <span class="token operator">-</span>ErrorAction <span class="token string">'SilentlyContinue'</span>
</code></pre>
<h3 id="windows-server-prerequisites">Windows Server Prerequisites</h3>
<p>There are several roles and features like IIS we need to install, to make this easier Nickolaj Andersen has created an application called the  <a href="https://gallery.technet.microsoft.com/ConfigMgr-2012-R2-e52919cd">ConfigMgr Prerequisite Tool</a>  that installs the required components. Download and extract the tool, then run ConfigMgrPrerequisitesTool.exe as an administrator.</p>
<p>On the left hand side select Settings then select Sources at the top. The Windows Server 2019 installation media should be in the DVD drive. Browse to the sources\sxs folder on the installation media.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ConfigMgr_Prerequisites2.png" alt=""></p>
<p>Switch to “Sites” on the left hand side and select “Preferences” from the top menu. Select all the drives EXCEPT for the Distribution Point disk (E:) and click “Create”. This creates a blank file called NO_SMS_ON_DRIVE.SMS at the root level of each selected disk. If Configuration Manager sees this file on a disk, the drive is ignored. This means that we are forcing Configuration Manager to only use the Distribution Point disk which is what we want.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ConfigMgr_Prerequisites3.png" alt=""></p>
<p>Change to the “Site Type” tab at the top. Then select “Primary Site” from the dropdown list and select the “Retry with alternate source location” box before pressing “Install”.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ConfigMgr_Prerequisites4.png" alt=""></p>
<p>Wait for the installation to complete, this could take a little while.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ConfigMgr_Prerequisites5.png" alt=""></p>
<p>Once the install has been completed press “Roles” on the left hand side. Select “Management Point” in the dropdown list and press “Install”.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ConfigMgr_Prerequisites6.png" alt=""></p>
<p>Repeat the process but this time select “Distribution Point” in the dropdown list.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ConfigMgr_Prerequisites7.png" alt=""></p>
<h3 id="windows-10-assessment-and-deployment-kit-adk">Windows 10 Assessment and Deployment Kit (ADK)</h3>
<p>The Windows 10 Assessment and Deployment Kit or ADK is a set of tools that can be used to customize and deploy Windows. The ADK can be  <a href="https://docs.microsoft.com/en-us/windows-hardware/get-started/adk-install">downloaded here</a>. At the time of writing the latest version of ADK is 1903, make sure to download the Windows PE add-on as well.</p>
<p>Start by running the ADK installer (adksetup.exe). Select a path where the ADK will be installed (as before we will be using the ConfigMgr disk) then press “Next”.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADK1.png" alt=""></p>
<p>Select at least the following 4 features and click “Install”.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADK2.png" alt=""></p>
<p>The download is around 850MB and could take a while depending on internet speed.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADK3.png" alt=""></p>
<p>Once the ADK is installed we need to install the Windows PE add-on (adkwinpesetup.exe).</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADK4.png" alt=""></p>
<p>There is only one option so make sure that Windows PE is selected.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADK5.png" alt=""></p>
<p>The Windows PE add-on is 5.7GB and could take a while depending on internet speed.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADK6.png" alt=""></p>
<h3 id="creating-the-system-management-container">Creating the System Management Container</h3>
<p>The System Management Container is where Configuration Manager will publish site information in Active Directory. This information will be used by clients and servers joined to Active Directory to find the Configuration Manager server. Below is a PowerShell script that will automatically create the Management Container in Active Directory.</p>
<p><strong>Note:</strong>  These steps need to be performed on LABADM01, where we earlier installed the required Active Directory tools. If you decided not to install a management server, then install the required administration tools on LABCM01. See the earlier post on  <a href="">Installing a Management Server</a>  for how to install the tools.</p>
<pre class=" language-powershell"><code class="prism  language-powershell"><span class="token variable">$CMServer</span> = <span class="token string">"LABCM01"</span>
<span class="token keyword">try</span>
<span class="token punctuation">{</span>
	<span class="token variable">$adDomain</span> = Get<span class="token operator">-</span>ADDomain
    <span class="token variable">$managementContainerPath</span> = <span class="token string">"CN=System,"</span> <span class="token operator">+</span> <span class="token variable">$adDomain</span><span class="token punctuation">.</span>DistinguishedName
	New<span class="token operator">-</span>ADObject <span class="token operator">-</span>path <span class="token variable">$managementContainerPath</span> <span class="token operator">-</span><span class="token function">Type</span> container <span class="token operator">-</span>name <span class="token string">"System Management"</span> <span class="token operator">-</span>WarningAction <span class="token string">'SilentlyContinue'</span> <span class="token operator">-</span>ErrorAction <span class="token string">'SilentlyContinue'</span> <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
	<span class="token variable">$managementContainerPath</span> = <span class="token string">"ad:CN=System Management,CN=System,"</span> <span class="token operator">+</span> <span class="token variable">$adDomain</span><span class="token punctuation">.</span>DistinguishedName
	<span class="token variable">$ACL</span> = Get<span class="token operator">-</span>Acl <span class="token variable">$managementContainerPath</span>
	<span class="token variable">$SID</span> = <span class="token punctuation">(</span>Get<span class="token operator">-</span>ADComputer <span class="token variable">$CMServer</span><span class="token punctuation">)</span><span class="token punctuation">.</span>SID
	<span class="token variable">$ActiveDirectoryRights</span> = <span class="token string">"GenericAll"</span>
	<span class="token variable">$AccessControlType</span> = <span class="token string">"Allow"</span>
	<span class="token variable">$Inherit</span> = <span class="token string">"All"</span>
	<span class="token variable">$nullGUID</span> = <span class="token namespace">[guid]</span><span class="token string">'00000000-0000-0000-0000-000000000000'</span>
	<span class="token variable">$ACE</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>DirectoryServices<span class="token punctuation">.</span>ActiveDirectoryAccessRule <span class="token variable">$SID</span><span class="token punctuation">,</span> <span class="token variable">$ActiveDirectoryRights</span><span class="token punctuation">,</span> <span class="token variable">$AccessControlType</span><span class="token punctuation">,</span> <span class="token variable">$Inherit</span><span class="token punctuation">,</span> <span class="token variable">$nullGUID</span>
	<span class="token variable">$ACL</span><span class="token punctuation">.</span>AddAccessRule<span class="token punctuation">(</span><span class="token variable">$ACE</span><span class="token punctuation">)</span>
	<span class="token function">Set</span><span class="token operator">-</span>Acl <span class="token operator">-</span>AclObject <span class="token variable">$ACL</span> <span class="token variable">$managementContainerPath</span>
    <span class="token function">Write-Host</span> <span class="token string">"Created the Management Container"</span>
<span class="token punctuation">}</span>
<span class="token keyword">catch</span>
<span class="token punctuation">{</span>
	<span class="token function">Write-Host</span> <span class="token string">"Failed to create the Management Container. Does it allready exist?"</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The Management Container can also be created/verified manually by performing the following steps:</p>
<p>Open ADSI Edit in Administrative Tools, from the Control Panel or Start Menu.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADSI1.png" alt=""></p>
<p>Right click on ADSI Edit and select “Connect To”, leave the defaults and press “OK”.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADSI3.png" alt=""></p>
<p>Locate CN=System and see if the CN=System Management container is present. If not, right click on CN=System and select New -&gt; Object.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADSI2.png" alt=""></p>
<p>Select “Container” from the list and click “Next”.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADSI4.png" alt=""></p>
<p>Type “System Management” into the value field. Make sure to spell this correctly or else it won’t work.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADSI5.png" alt=""></p>
<p>Once the System Management container is created right click on it and select “Properties”, then select the Security tab. Add LABCM01 (remember to add Computer as an object type) and give it Full Control.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADSI6.png" alt=""></p>
<p>Click on Advanced to open the Advanced Security Settings page. Find LABCM01 in the list and click edit.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADSI7.png" alt=""></p>
<p>Under “Applies to” select “This object and all descendant objects”. Press “OK” and apply the settings. Close the remaining security windows.</p>
<p><img src="https://github.com/albert-projects/home-lab/blob/16cc4642778941f956f39704a2f6ffd482d6a4e3/Creating-A-Configuration-Manager-(SCCM)-LAB-Environment-Part-4-Configuration-Manager-Prerequisites/ADSI8.png" alt=""></p>
<p>We have now installed all of the prerequisites required,  <a href="">in the next post we will finally be installing Configuration Manager</a>. Make sure that the server is restarted as there have been a lot of changes made.</p>

